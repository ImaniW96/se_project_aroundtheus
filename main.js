!function(){"use strict";class e{constructor(e,t,s,r,i){this._cardData=e,this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=r,this._handleLikeClick=i,this.id=e._id,this._likes=e.likes,this.isLiked=e.isLiked}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardDeleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick(this._cardData)}))}deleteCard(){this._cardElement.remove(),this._cardElement=null}renderLike(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}setIsLiked(){this.isLiked=!this.isLiked,this.renderLike()}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement}getView(){return this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".card__like-button"),this._cardDeleteButton=this._element.querySelector(".card__trash-icon"),this._cardImageEl=this._element.querySelector(".card__image"),this._cardTitleEl=this._element.querySelector(".card__title"),this._cardImageEl.setAttribute("src",this._link),this._cardImageEl.setAttribute("alt",this._name),this._cardTitleEl.textContent=this._name,this._setEventListeners(),this.renderLike(),this._cardElement}}var t=class{constructor(e,t){this._settings=e,this._form=t,this._inputErrorClass=e._inputErrorClass,this._submitButton=this._form.querySelector(this._settings.submitButtonSelector),this._inputEls=[...this._form.querySelectorAll(this._settings.inputSelector)]}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._settings.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._settings.errorClass)}_setEventListeners(){this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_toggleButtonState(e){if(this._hasInvalidInput())return this._submitButton.classList.add(this._settings.inactiveButtonClass),void(this._submitButton.disabled=!0);this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.disabled=!1}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.textContent="",t.classList.remove(this._settings.errorClass)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}};class s{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._popupCloseButton=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscapeClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscapeClose)}_handleEscapeClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target!==this._popupCloseButton&&e.target!==this._popupElement||this.close()}))}}class i extends r{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._submitButton=this._popupForm.querySelector(".modal__button")}setSubmitAction(e){this._handleFormSubmit=e}_getInputValues(){const e={};return this._popupForm.querySelectorAll(".modal__input").forEach((t=>{e[t.name]=t.value})),e}close(){this._popupForm.reset(),super.close()}setEventListeners(){console.log(this._popupForm),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t)})),super.setEventListeners()}setSubmitButtonText(e){this._submitButton.textContent=e}}const o=document.querySelector("#profile-edit-button"),n=document.querySelector("#profile-edit-modal"),l=document.querySelector("#profile-add-modal"),a=document.querySelector("#profile-picture-icon"),c=(document.querySelector("#preview-card-modal"),document.querySelector(".profile__title"),document.querySelector(".modal__image"),document.querySelector(".modal__caption"),document.querySelector("#profile-icon")),d=(document.querySelector(".profile__description"),document.querySelector(".profile__add-button")),u=document.querySelector("#profile-edit-title-input"),h=(document.querySelector("#add-title-input"),document.querySelector("#profile-description-input")),_=n.querySelector(".modal__form"),m=l.querySelector(".modal__form"),p=a.querySelector(".modal__form"),S=(document.querySelector(".cards__list"),document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,document.querySelector("#edit-profile-close-button"),document.querySelector("#add-card-close-button"),m.querySelector(".modal__input_type_url"),m.querySelector(".modal__input_type_url"),document.querySelector("#preview-card-image-close-button"),{formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visable"}),E=new i("#profile-add-modal",(e=>{E.setSubmitButtonText("Saving...."),C.createCard(e).then((e=>{const t=T(e);x.addItem(t),E.close(),L.resetValidation()})).finally((()=>{E.setSubmitButtonText("Save")}))})),b=new i("#confirm-card-delete",(e=>{b.setSubmitButtonText("Deleting...."),C.deleteCard(card.id).then((()=>{card.deleteCard(),b.close(),renderItems()})).catch((e=>{console.error(e)})).finally((()=>{b.setSubmitButtonText("Delete")}))})),f=new i("#profile-picture-icon",(e=>{f.setSubmitButtonText("Saving...."),C.updateProfilePicture(e).then((e=>{k.setUserAvatar(e),f.close()})).catch((e=>{console.error(e)})).finally((()=>{f.setSubmitButtonText("Save")}))}));b.setEventListeners();const v=new i("#profile-edit-modal",(e=>{console.log(e),g.resetValidation(),v.close(),console.log(e),v.setSubmitButtonText("Saving...."),C.editUserProfile({name:e.name,about:e.about}).then((e=>{let{name:t,about:s}=e;k.setUserInfo({name:t,about:s})})).catch((e=>{console.error(e),alert(`${e}.Failed to update profile`)})).finally((()=>{v.setSubmitButtonText("Save")}))}));document.querySelector(".modal__form"),E.setEventListeners(),v.setEventListeners();const y=new class extends r{constructor(e){super({popupSelector:e})}open(e){const t=this._popupElement.querySelector(".modal__image");t.src=e.link,t.alt=e.name,this._popupElement.querySelector(".modal__caption").textContent=e.name,super.open()}}("#preview-card-modal");y.setEventListeners();const k=new class{constructor(e,t,s){this._name=document.querySelector(e),this._about=document.querySelector(t),this._avatar=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){this._name.textContent=e.name,this._about.textContent=e.about}setUserAvatar(e){this._avatar.src=e.avatar}}(".profile__title",".profile__description",".profile__image"),g=new t(S,_),L=new t(S,m),q=new t(S,p),C=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then((e=>this.checkResponse(e)))}createCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then((e=>this.checkResponse(e)))}editUserProfile(e){return console.log(e),fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then((e=>this.checkResponse(e)))}likeCard(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>this.checkResponse(e)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>this.checkResponse(e)))}loadUserInfo(){return fetch("https://around-api.en.tripleten-services.com/v1/users/me",{method:"GET",headers:this._headers}).then((e=>this.checkResponse(e)))}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar `,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.link})}).then((e=>this.checkResponse(e)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"e3f5bc64-c279-4474-9c65-8c5ae0831eb9","Content-Type":"application/json"}});function I(e){y.open(e)}function B(e){console.log(e),b.open(),b.setSubmitAction((()=>{b.setSubmitButtonText("Deleting...."),C.deleteCard(e.id).then((()=>{e.deleteCard(),b.close()})).catch((e=>{console.error(e)})).finally((()=>{b.setSubmitButtonText("Delete")}))}))}function T(t){return new e(t,"#card-template",I,B,U).getView()}let x;function U(e){C.likeCard(e.id,e.isLiked).then((t=>{e.setIsLiked()})).catch((e=>{console.error(e),alert(`${e}. Failed to like or dislike card`)}))}f.setEventListeners(),c.addEventListener("click",(()=>{f.open()})),o.addEventListener("click",(()=>{const{name:e,about:t}=k.getUserInfo();u.value=e,h.value=t,g.resetValidation(),v.open()})),d.addEventListener("click",(()=>{E.open()})),g.enableValidation(),L.enableValidation(),q.enableValidation(),C.loadUserInfo().then((e=>{k.setUserInfo(e),k.setUserAvatar(e)})).catch((e=>{console.error(e),alert(`${e}. Failed to get user info.`)})),C.getInitialCards().then((e=>{x=new s({items:e.reverse(),renderer:e=>{const t=T(e);x.addItem(t)}},".cards__list"),x.renderItems()})).catch((e=>{console.error(e),alert(`${e}. Failed to add card.`)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQWUsTUFBTUEsRUFDbkJDLFdBQUFBLENBQ0VDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBRUFDLEtBQUtDLFVBQVlOLEVBQ2pCSyxLQUFLRSxNQUFRUCxFQUFTUSxLQUN0QkgsS0FBS0ksTUFBUVQsRUFBU1UsS0FDdEJMLEtBQUtNLGNBQWdCVixFQUNyQkksS0FBS08sa0JBQW9CVixFQUN6QkcsS0FBS1EsbUJBQXFCVixFQUMxQkUsS0FBS1MsaUJBQW1CVixFQUN4QkMsS0FBS1UsR0FBS2YsRUFBU2dCLElBQ25CWCxLQUFLWSxPQUFTakIsRUFBU2tCLE1BQ3ZCYixLQUFLYyxRQUFVbkIsRUFBU21CLE9BQzFCLENBRUFDLGtCQUFBQSxHQUNFZixLQUFLZ0IsWUFBWUMsaUJBQWlCLFNBQVMsS0FDekNqQixLQUFLUyxpQkFBaUJULEtBQUssSUFHN0JBLEtBQUtrQixrQkFBa0JELGlCQUFpQixTQUFTLEtBQy9DakIsS0FBS1EsbUJBQW1CUixLQUFLLElBRS9CQSxLQUFLbUIsYUFBYUYsaUJBQWlCLFNBQVMsS0FDMUNqQixLQUFLTyxrQkFBa0JQLEtBQUtDLFVBQVUsR0FFMUMsQ0FDQW1CLFVBQUFBLEdBQ0VwQixLQUFLcUIsYUFBYUMsU0FDbEJ0QixLQUFLcUIsYUFBZSxJQUN0QixDQUVBRSxVQUFBQSxHQUNNdkIsS0FBS2MsUUFDUGQsS0FBS2dCLFlBQVlRLFVBQVVDLElBQUksNEJBRS9CekIsS0FBS2dCLFlBQVlRLFVBQVVGLE9BQU8sMkJBRXRDLENBRUFJLFVBQUFBLEdBQ0UxQixLQUFLYyxTQUFXZCxLQUFLYyxRQUNyQmQsS0FBS3VCLFlBQ1AsQ0FDQUksWUFBQUEsR0FLRSxPQUpBM0IsS0FBS3FCLGFBQWVPLFNBQ2pCQyxjQUFjN0IsS0FBS00sZUFDbkJ3QixRQUFRRCxjQUFjLFNBQ3RCRSxXQUFVLEdBQ04vQixLQUFLcUIsWUFDZCxDQUNBVyxPQUFBQSxHQVlFLE9BWEFoQyxLQUFLaUMsU0FBV2pDLEtBQUsyQixlQUNyQjNCLEtBQUtnQixZQUFjaEIsS0FBS2lDLFNBQVNKLGNBQWMsc0JBQy9DN0IsS0FBS2tCLGtCQUFvQmxCLEtBQUtpQyxTQUFTSixjQUFjLHFCQUNyRDdCLEtBQUttQixhQUFlbkIsS0FBS2lDLFNBQVNKLGNBQWMsZ0JBQ2hEN0IsS0FBS2tDLGFBQWVsQyxLQUFLaUMsU0FBU0osY0FBYyxnQkFDaEQ3QixLQUFLbUIsYUFBYWdCLGFBQWEsTUFBT25DLEtBQUtJLE9BQzNDSixLQUFLbUIsYUFBYWdCLGFBQWEsTUFBT25DLEtBQUtFLE9BQzNDRixLQUFLa0MsYUFBYUUsWUFBY3BDLEtBQUtFLE1BRXJDRixLQUFLZSxxQkFDTGYsS0FBS3VCLGFBQ0V2QixLQUFLcUIsWUFDZCxFQ05GLE1BL0RBLE1BQ0UzQixXQUFBQSxDQUFZMkMsRUFBVUMsR0FDcEJ0QyxLQUFLdUMsVUFBWUYsRUFDakJyQyxLQUFLd0MsTUFBUUYsRUFDYnRDLEtBQUt5QyxpQkFBbUJKLEVBQVNJLGlCQUNqQ3pDLEtBQUswQyxjQUFnQjFDLEtBQUt3QyxNQUFNWCxjQUM5QjdCLEtBQUt1QyxVQUFVSSxzQkFFakIzQyxLQUFLNEMsVUFBWSxJQUNaNUMsS0FBS3dDLE1BQU1LLGlCQUFpQjdDLEtBQUt1QyxVQUFVTyxlQUVsRCxDQUNBQyxlQUFBQSxDQUFnQkMsR0FDZCxNQUFNQyxFQUFpQmpELEtBQUt3QyxNQUFNWCxjQUFlLElBQUdtQixFQUFRdEMsWUFDNURzQyxFQUFReEIsVUFBVUMsSUFBSXpCLEtBQUt1QyxVQUFVVyxpQkFDckNELEVBQWViLFlBQWNZLEVBQVFHLGtCQUNyQ0YsRUFBZXpCLFVBQVVDLElBQUl6QixLQUFLdUMsVUFBVWEsV0FDOUMsQ0FDQXJDLGtCQUFBQSxHQUNFZixLQUFLNEMsVUFBVVMsU0FBU0wsSUFDdEJBLEVBQVEvQixpQkFBaUIsU0FBVXFDLElBQ2pDdEQsS0FBS3VELG9CQUFvQlAsR0FDekJoRCxLQUFLd0Qsb0JBQW9CLEdBQ3pCLEdBRU4sQ0FDQUMsZ0JBQUFBLEdBQ0V6RCxLQUFLd0MsTUFBTXZCLGlCQUFpQixVQUFXcUMsSUFDckNBLEVBQUVJLGdCQUFnQixJQUVwQjFELEtBQUtlLG9CQUNQLENBQ0F3QyxtQkFBQUEsQ0FBb0JQLEdBQ2xCLElBQUtBLEVBQVFXLFNBQVNDLE1BQ3BCLE9BQU81RCxLQUFLK0MsZ0JBQWdCQyxHQUU5QmhELEtBQUs2RCxnQkFBZ0JiLEVBQ3ZCLENBQ0FRLGtCQUFBQSxDQUFtQlIsR0FDakIsR0FBSWhELEtBQUs4RCxtQkFHUCxPQUZBOUQsS0FBSzBDLGNBQWNsQixVQUFVQyxJQUFJekIsS0FBS3VDLFVBQVV3QiwwQkFDaEQvRCxLQUFLMEMsY0FBY3NCLFVBQVcsR0FHaENoRSxLQUFLMEMsY0FBY2xCLFVBQVVGLE9BQU90QixLQUFLdUMsVUFBVXdCLHFCQUNuRC9ELEtBQUswQyxjQUFjc0IsVUFBVyxDQUNoQyxDQUNBSCxlQUFBQSxDQUFnQmIsR0FDZCxNQUFNQyxFQUFpQmpELEtBQUt3QyxNQUFNWCxjQUFlLElBQUdtQixFQUFRdEMsWUFDNURzQyxFQUFReEIsVUFBVUYsT0FBT3RCLEtBQUt1QyxVQUFVVyxpQkFDeENELEVBQWViLFlBQWMsR0FDN0JhLEVBQWV6QixVQUFVRixPQUFPdEIsS0FBS3VDLFVBQVVhLFdBQ2pELENBQ0FVLGdCQUFBQSxHQUNFLE9BQVE5RCxLQUFLNEMsVUFBVXFCLE9BQU9qQixHQUFZQSxFQUFRVyxTQUFTQyxPQUM3RCxDQUNBTSxlQUFBQSxHQUNFbEUsS0FBS3dELHFCQUNMeEQsS0FBSzRDLFVBQVVTLFNBQVNMLElBQ3RCaEQsS0FBSzZELGdCQUFnQmIsRUFBUSxHQUVqQyxHQzdEYSxNQUFNbUIsRUFDbkJ6RSxXQUFBQSxDQUFXMEUsRUFBc0JDLEdBQW1CLElBQXhDLE1BQUVDLEVBQUssU0FBRUMsR0FBVUgsRUFDN0JwRSxLQUFLd0UsT0FBU0YsRUFDZHRFLEtBQUt5RSxVQUFZRixFQUNqQnZFLEtBQUswRSxXQUFhOUMsU0FBU0MsY0FBY3dDLEVBQzNDLENBQ0FNLFdBQUFBLEdBQ0UzRSxLQUFLd0UsT0FBT25CLFNBQVN1QixJQUNuQjVFLEtBQUt5RSxVQUFVRyxFQUFLLEdBRXhCLENBQ0FDLE9BQUFBLENBQVFDLEdBQ045RSxLQUFLMEUsV0FBV0ssUUFBUUQsRUFDMUIsRUNiYSxNQUFNRSxFQUNuQnRGLFdBQUFBLENBQVcwRSxHQUFvQixJQUFuQixjQUFFYSxHQUFlYixFQUMzQnBFLEtBQUtrRixjQUFnQnRELFNBQVNDLGNBQWNvRCxHQUM1Q2pGLEtBQUttRixrQkFBb0JuRixLQUFLa0YsY0FBY3JELGNBQWMsZ0JBQzVELENBQ0F1RCxJQUFBQSxHQUNFcEYsS0FBS2tGLGNBQWMxRCxVQUFVQyxJQUFJLGdCQUNqQ0csU0FBU1gsaUJBQWlCLFVBQVdqQixLQUFLcUYsbUJBQzVDLENBQ0FDLEtBQUFBLEdBQ0V0RixLQUFLa0YsY0FBYzFELFVBQVVGLE9BQU8sZ0JBQ3BDTSxTQUFTMkQsb0JBQW9CLFVBQVd2RixLQUFLcUYsbUJBQy9DLENBQ0FBLG1CQUFzQkcsSUFDSixXQUFaQSxFQUFJQyxLQUNOekYsS0FBS3NGLE9BQ1AsRUFFRkksaUJBQUFBLEdBQ0UxRixLQUFLa0YsY0FBY2pFLGlCQUFpQixTQUFVdUUsSUFDeENBLEVBQUlHLFNBQVczRixLQUFLbUYsbUJBQW9CSyxFQUFJRyxTQUFXM0YsS0FBS2tGLGVBQzlEbEYsS0FBS3NGLE9BQ1AsR0FFSixFQ3ZCYSxNQUFNTSxVQUFzQlosRUFDekN0RixXQUFBQSxDQUFZdUYsRUFBZVksR0FDekJDLE1BQU0sQ0FBRWIsa0JBQ1JqRixLQUFLK0YsV0FBYS9GLEtBQUtrRixjQUFjckQsY0FBYyxnQkFDbkQ3QixLQUFLZ0csa0JBQW9CSCxFQUN6QjdGLEtBQUswQyxjQUFnQjFDLEtBQUsrRixXQUFXbEUsY0FBYyxpQkFDckQsQ0FDQW9FLGVBQUFBLENBQWdCQyxHQUNkbEcsS0FBS2dHLGtCQUFvQkUsQ0FDM0IsQ0FDQUMsZUFBQUEsR0FDRSxNQUFNQyxFQUFjLENBQUMsRUFLckIsT0FKc0JwRyxLQUFLK0YsV0FBV2xELGlCQUFpQixpQkFDekNRLFNBQVNnRCxJQUNyQkQsRUFBWUMsRUFBTWxHLE1BQVFrRyxFQUFNQyxLQUFLLElBRWhDRixDQUNULENBQ0FkLEtBQUFBLEdBQ0V0RixLQUFLK0YsV0FBV1EsUUFDaEJULE1BQU1SLE9BQ1IsQ0FDQUksaUJBQUFBLEdBQ0VjLFFBQVFDLElBQUl6RyxLQUFLK0YsWUFDakIvRixLQUFLK0YsV0FBVzlFLGlCQUFpQixVQUFXdUUsSUFDMUNBLEVBQUk5QixpQkFDSixNQUFNMEMsRUFBY3BHLEtBQUttRyxrQkFDekJuRyxLQUFLZ0csa0JBQWtCSSxFQUFZLElBRXJDTixNQUFNSixtQkFDUixDQUNBZ0IsbUJBQUFBLENBQW9CQyxHQUNsQjNHLEtBQUswQyxjQUFjTixZQUFjdUUsQ0FDbkMsRUNsQ0ssTUFBTUMsRUFBb0JoRixTQUFTQyxjQUFjLHdCQUMzQ2dGLEVBQW1CakYsU0FBU0MsY0FBYyx1QkFDMUNpRixFQUFXbEYsU0FBU0MsY0FBYyxzQkFDbENrRixFQUFzQm5GLFNBQVNDLGNBQzFDLHlCQU1XbUYsR0FKbUJwRixTQUFTQyxjQUFjLHVCQUMzQkQsU0FBU0MsY0FBYyxtQkFDckJELFNBQVNDLGNBQWMsaUJBQ3JCRCxTQUFTQyxjQUFjLG1CQUM1QkQsU0FBU0MsY0FBYyxrQkFLckNvRixHQUhxQnJGLFNBQVNDLGNBQ3pDLHlCQUU4QkQsU0FBU0MsY0FBYyx5QkFDMUNxRixFQUFvQnRGLFNBQVNDLGNBQ3hDLDZCQUdXc0YsR0FEb0J2RixTQUFTQyxjQUFjLG9CQUNqQkQsU0FBU0MsY0FDOUMsK0JBR1d1RixFQUFrQlAsRUFBaUJoRixjQUFjLGdCQUVqRHdGLEVBQVVQLEVBQVNqRixjQUFjLGdCQUNqQ3lGLEVBQ1hQLEVBQW9CbEYsY0FBYyxnQkFtQnZCMEYsR0FsQlkzRixTQUFTQyxjQUFjLGdCQUN4QkQsU0FBU0MsY0FBYyxnQkFFN0NELFNBQVNDLGNBQWMsa0JBQWtCQyxRQUFRMEYsa0JBQ2I1RixTQUFTQyxjQUM3Qyw4QkFHZ0NELFNBQVNDLGNBQ3pDLDBCQUUwQndGLEVBQVF4RixjQUFjLDBCQUNuQndGLEVBQVF4RixjQUFjLDBCQUNmRCxTQUFTQyxjQUM3QyxvQ0FJb0IsQ0FDcEI0RixhQUFjLGVBQ2QzRSxjQUFlLGdCQUNmSCxxQkFBc0IsaUJBQ3RCb0Isb0JBQXFCLHlCQUNyQmIsZ0JBQWlCLDBCQUNqQkUsV0FBWSx5QkNWUnNFLEVBQWUsSUFBSTlCLEVBQWMsc0JBQXVCUSxJQUM1RHNCLEVBQWFoQixvQkFBb0IsY0FDakNpQixFQUNHQyxXQUFXeEIsR0FDWHlCLE1BQU1DLElBQ0wsTUFBTUMsRUFBY0gsRUFBV0UsR0FDL0JFLEVBQVFuRCxRQUFRa0QsR0FDaEJMLEVBQWFwQyxRQUNiMkMsRUFBaUIvRCxpQkFBaUIsSUFFbkNnRSxTQUFRLEtBQ1BSLEVBQWFoQixvQkFBb0IsT0FBTyxHQUN4QyxJQUVBeUIsRUFBcUIsSUFBSXZDLEVBQzdCLHdCQUNDUSxJQUNDK0IsRUFBbUJ6QixvQkFBb0IsZ0JBQ3ZDaUIsRUFDR3ZHLFdBQVdnSCxLQUFLMUgsSUFDaEJtSCxNQUFLLEtBQ0pPLEtBQUtoSCxhQUNMK0csRUFBbUI3QyxRQUNuQlgsYUFBYSxJQUVkMEQsT0FBT0MsSUFDTjlCLFFBQVErQixNQUFNRCxFQUFJLElBRW5CSixTQUFRLEtBQ1BDLEVBQW1CekIsb0JBQW9CLFNBQVMsR0FDaEQsSUFHRjhCLEVBQXVCLElBQUk1QyxFQUMvQix5QkFDQ1EsSUFDQ29DLEVBQXFCOUIsb0JBQW9CLGNBQ3pDaUIsRUFDR2MscUJBQXFCckMsR0FDckJ5QixNQUFNQyxJQUNMWSxFQUFTQyxjQUFjYixHQUN2QlUsRUFBcUJsRCxPQUFPLElBRTdCK0MsT0FBT0MsSUFDTjlCLFFBQVErQixNQUFNRCxFQUFJLElBRW5CSixTQUFRLEtBQ1BNLEVBQXFCOUIsb0JBQW9CLE9BQU8sR0FDaEQsSUFJUnlCLEVBQW1CekMsb0JBRW5CLE1BQU1rRCxFQUFtQixJQUFJaEQsRUFDM0IsdUJBQ0NRLElBQ0NJLFFBQVFDLElBQUlMLEdBRVp5QyxFQUFrQjNFLGtCQUVsQjBFLEVBQWlCdEQsUUFFakJrQixRQUFRQyxJQUFJTCxHQUNad0MsRUFBaUJsQyxvQkFBb0IsY0FDckNpQixFQUNHbUIsZ0JBQWdCLENBQ2YzSSxLQUFNaUcsRUFBWWpHLEtBQ2xCNEksTUFBTzNDLEVBQVkyQyxRQUdwQmxCLE1BQUt6RCxJQUFxQixJQUFwQixLQUFFakUsRUFBSSxNQUFFNEksR0FBTzNFLEVBQ3BCc0UsRUFBU00sWUFBWSxDQUFFN0ksT0FBTTRJLFNBQVEsSUFFdENWLE9BQU9DLElBQ045QixRQUFRK0IsTUFBTUQsR0FDZFcsTUFBTyxHQUFFWCw2QkFBK0IsSUFFekNKLFNBQVEsS0FDUFUsRUFBaUJsQyxvQkFBb0IsT0FBTyxHQUM1QyxJQUlTOUUsU0FBU0MsY0FBYyxnQkFDeEM2RixFQUFhaEMsb0JBQ2JrRCxFQUFpQmxELG9CQUNqQixNQUFNd0QsRUFBaUIsSUNoSVIsY0FBNkJsRSxFQUMxQ3RGLFdBQUFBLENBQVl1RixHQUNWYSxNQUFNLENBQUViLGlCQUNWLENBQ0FHLElBQUFBLENBQUt6RixHQUNILE1BQU13SixFQUFhbkosS0FBS2tGLGNBQWNyRCxjQUFjLGlCQUNwRHNILEVBQVdDLElBQU16SixFQUFTVSxLQUMxQjhJLEVBQVdFLElBQU0xSixFQUFTUSxLQUNMSCxLQUFLa0YsY0FBY3JELGNBQWMsbUJBQ3pDTyxZQUFjekMsRUFBU1EsS0FDcEMyRixNQUFNVixNQUNSLEdEcUh3Qyx1QkFDMUM4RCxFQUFleEQsb0JBSWYsTUFBTWdELEVBQVcsSUV2SUYsTUFDYmhKLFdBQUFBLENBQVk0SixFQUFjQyxFQUFlQyxHQUN2Q3hKLEtBQUtFLE1BQVEwQixTQUFTQyxjQUFjeUgsR0FDcEN0SixLQUFLeUosT0FBUzdILFNBQVNDLGNBQWMwSCxHQUNyQ3ZKLEtBQUswSixRQUFVOUgsU0FBU0MsY0FBYzJILEVBQ3hDLENBQ0FHLFdBQUFBLEdBQ0UsTUFBTyxDQUNMeEosS0FBTUgsS0FBS0UsTUFBTWtDLFlBQ2pCMkcsTUFBTy9JLEtBQUt5SixPQUFPckgsWUFFdkIsQ0FFQTRHLFdBQUFBLENBQVk1QyxHQUNWcEcsS0FBS0UsTUFBTWtDLFlBQWNnRSxFQUFZakcsS0FDckNILEtBQUt5SixPQUFPckgsWUFBY2dFLEVBQVkyQyxLQUN4QyxDQUNBSixhQUFBQSxDQUFjdkMsR0FDWnBHLEtBQUswSixRQUFRTixJQUFNaEQsRUFBWXdELE1BQ2pDLEdGcUhBLGtCQUNBLHdCQUNBLG1CQUdJZixFQUFvQixJQUFJZ0IsRUFBY3RDLEVBQVFILEdBQzlDYSxFQUFtQixJQUFJNEIsRUFBY3RDLEVBQVFGLEdBQzdDeUMsRUFBMEIsSUFBSUQsRUFBY3RDLEVBQVFELEdBRXBESyxFQUFNLElHakpHLE1BQ2JqSSxXQUFBQSxDQUFXMEUsR0FBdUIsSUFBdEIsUUFBRTJGLEVBQU8sUUFBRUMsR0FBUzVGLEVBQzlCcEUsS0FBS2lLLFNBQVdGLEVBQ2hCL0osS0FBS2tLLFNBQVdGLENBQ2xCLENBRUFHLGFBQUFBLENBQWNyQyxHQUNaLE9BQUlBLEVBQUlzQyxHQUNDdEMsRUFBSXVDLE9BRU5DLFFBQVFDLE9BQVEsVUFBU3pDLEVBQUkwQyxTQUN0QyxDQUVBQyxlQUFBQSxHQUNFLE9BQU9DLE1BQU8sR0FBRTFLLEtBQUtpSyxpQkFBa0IsQ0FDckNVLE9BQVEsTUFDUlgsUUFBU2hLLEtBQUtrSyxXQUNickMsTUFBTUMsR0FDQTlILEtBQUttSyxjQUFjckMsSUFFOUIsQ0FFQUYsVUFBQUEsQ0FBV3hCLEdBQ1QsT0FBT3NFLE1BQU8sR0FBRTFLLEtBQUtpSyxpQkFBa0IsQ0FDckNVLE9BQVEsT0FDUlgsUUFBU2hLLEtBQUtrSyxTQUNkVSxLQUFNQyxLQUFLQyxVQUFVMUUsS0FDcEJ5QixNQUFNQyxHQUNBOUgsS0FBS21LLGNBQWNyQyxJQUU5QixDQUNBZ0IsZUFBQUEsQ0FBZ0JoQixHQUVkLE9BREF0QixRQUFRQyxJQUFJcUIsR0FDTDRDLE1BQU8sR0FBRTFLLEtBQUtpSyxvQkFBcUIsQ0FDeENVLE9BQVEsUUFDUlgsUUFBU2hLLEtBQUtrSyxTQUNkVSxLQUFNQyxLQUFLQyxVQUFVLENBQ25CM0ssS0FBTTJILEVBQUkzSCxLQUNWNEksTUFBT2pCLEVBQUlpQixVQUVabEIsTUFBTUMsR0FDQTlILEtBQUttSyxjQUFjckMsSUFFOUIsQ0FFQWlELFFBQUFBLENBQVNDLEVBQVFsSyxHQUNmLE9BQU80SixNQUFPLEdBQUUxSyxLQUFLaUssa0JBQWtCZSxVQUFnQixDQUNyREwsT0FBUTdKLEVBQVUsU0FBVyxNQUM3QmtKLFFBQVNoSyxLQUFLa0ssV0FDYnJDLE1BQU1DLEdBQ0E5SCxLQUFLbUssY0FBY3JDLElBRTlCLENBQ0ExRyxVQUFBQSxDQUFXNEosR0FDVCxPQUFPTixNQUFPLEdBQUUxSyxLQUFLaUssa0JBQWtCZSxJQUFVLENBQy9DTCxPQUFRLFNBQ1JYLFFBQVNoSyxLQUFLa0ssV0FDYnJDLE1BQU1DLEdBQ0E5SCxLQUFLbUssY0FBY3JDLElBRTlCLENBRUFtRCxZQUFBQSxHQUNFLE9BQU9QLE1BQU0sMkRBQTRELENBQ3ZFQyxPQUFRLE1BQ1JYLFFBQVNoSyxLQUFLa0ssV0FDYnJDLE1BQU1DLEdBQ0E5SCxLQUFLbUssY0FBY3JDLElBRTlCLENBQ0FXLG9CQUFBQSxDQUFxQnJDLEdBQ25CLE9BQU9zRSxNQUFPLEdBQUUxSyxLQUFLaUssNEJBQTZCLENBQ2hEVSxPQUFRLFFBQ1JYLFFBQVNoSyxLQUFLa0ssU0FDZFUsS0FBTUMsS0FBS0MsVUFBVSxDQUFFbEIsT0FBUXhELEVBQVkvRixTQUMxQ3dILE1BQU1DLEdBQ0E5SCxLQUFLbUssY0FBY3JDLElBRTlCLEdIbUVrQixDQUNsQmlDLFFBQVMsa0RBQ1RDLFFBQVMsQ0FDUGtCLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBS3BCLFNBQVNyTCxFQUFpQkYsR0FDeEJ1SixFQUFlOUQsS0FBS3pGLEVBQ3RCLENBT0EsU0FBU0csRUFBa0JzSSxHQUN6QjVCLFFBQVFDLElBQUkyQixHQUNaRCxFQUFtQi9DLE9BQ25CK0MsRUFBbUJsQyxpQkFBZ0IsS0FDakNrQyxFQUFtQnpCLG9CQUFvQixnQkFFdkNpQixFQUNHdkcsV0FBV2dILEVBQUsxSCxJQUNoQm1ILE1BQUssS0FDSk8sRUFBS2hILGFBQ0wrRyxFQUFtQjdDLE9BQU8sSUFFM0IrQyxPQUFPQyxJQUNOOUIsUUFBUStCLE1BQU1ELEVBQUksSUFFbkJKLFNBQVEsS0FDUEMsRUFBbUJ6QixvQkFBb0IsU0FBUyxHQUNoRCxHQUVSLENBbUJBLFNBQVNrQixFQUFXakksR0FTbEIsT0FSYSxJQUFJRixFQUNmRSxFQUNBLGlCQUNBRSxFQUNBQyxFQUVBQyxHQUVVaUMsU0FDZCxDQXFCQSxJQUFJZ0csRUFzQkosU0FBU2pJLEVBQWdCcUksR0FDdkJULEVBQ0dvRCxTQUFTM0MsRUFBSzFILEdBQUkwSCxFQUFLdEgsU0FDdkIrRyxNQUFNQyxJQUNMTSxFQUFLMUcsWUFBWSxJQUVsQjJHLE9BQU9DLElBQ045QixRQUFRK0IsTUFBTUQsR0FDZFcsTUFBTyxHQUFFWCxvQ0FBc0MsR0FFckQsQ0EvRUFFLEVBQXFCOUMsb0JBQ3JCc0IsRUFBWS9GLGlCQUFpQixTQUFTLEtBQ3BDdUgsRUFBcUJwRCxNQUFNLElBRzdCd0IsRUFBa0IzRixpQkFBaUIsU0FBUyxLQUMxQyxNQUFNLEtBQUVkLEVBQUksTUFBRTRJLEdBQVVMLEVBQVNpQixjQUNqQ3pDLEVBQWtCWixNQUFRbkcsRUFDMUJnSCxFQUF3QmIsTUFBUXlDLEVBQ2hDRixFQUFrQjNFLGtCQUNsQjBFLEVBQWlCeEQsTUFBTSxJQUV6QjZCLEVBQWlCaEcsaUJBQWlCLFNBQVMsS0FDekN5RyxFQUFhdEMsTUFBTSxJQWtCckJ5RCxFQUFrQnBGLG1CQUNsQndFLEVBQWlCeEUsbUJBQ2pCcUcsRUFBd0JyRyxtQkFFeEJrRSxFQUNHc0QsZUFDQXBELE1BQU1zRCxJQUNMekMsRUFBU00sWUFBWW1DLEdBQ3JCekMsRUFBU0MsY0FBY3dDLEVBQUssSUFFN0I5QyxPQUFPQyxJQUNOOUIsUUFBUStCLE1BQU1ELEdBQ2RXLE1BQU8sR0FBRVgsOEJBQWdDLElBTTdDWCxFQUNHOEMsa0JBQ0E1QyxNQUFNdUQsSUFDTHBELEVBQVUsSUFBSTdELEVBQ1osQ0FDRUcsTUFBTzhHLEVBQU1DLFVBQ2I5RyxTQUFXNUUsSUFDVCxNQUFNb0ksRUFBY0gsRUFBV2pJLEdBQy9CcUksRUFBUW5ELFFBQVFrRCxFQUFZLEdBR2hDLGdCQUVGQyxFQUFRckQsYUFBYSxJQUV0QjBELE9BQU9DLElBQ045QixRQUFRK0IsTUFBTUQsR0FDZFcsTUFBTyxHQUFFWCx5QkFBMkIsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgY2FyZERhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICApIHtcclxuICAgIHRoaXMuX2NhcmREYXRhID0gY2FyZERhdGE7XHJcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gICAgdGhpcy5pZCA9IGNhcmREYXRhLl9pZDtcclxuICAgIHRoaXMuX2xpa2VzID0gY2FyZERhdGEubGlrZXM7XHJcbiAgICB0aGlzLmlzTGlrZWQgPSBjYXJkRGF0YS5pc0xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX2NhcmREYXRhKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBkZWxldGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMaWtlKCkge1xyXG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRJc0xpa2VkKCkge1xyXG4gICAgdGhpcy5pc0xpa2VkID0gIXRoaXMuaXNMaWtlZDtcclxuICAgIHRoaXMucmVuZGVyTGlrZSgpO1xyXG4gIH1cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9jYXJkRGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoLWljb25cIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuX2xpbmspO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuc2V0QXR0cmlidXRlKFwiYWx0XCIsIHRoaXMuX25hbWUpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLnJlbmRlckxpa2UoKTtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzOyAvL2NvbmZpZyAgdGhpcy5fc2V0dGluZ3MuZm9ybVNlbGVjdG9yXHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5faW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMuX2lucHV0RWxzID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvciksXHJcbiAgICBdO1xyXG4gIH1cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xyXG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH1cclxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gIH1cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRFbCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0RWxzLmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cENsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG4gIH1cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NhcGVDbG9zZSk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NhcGVDbG9zZSk7XHJcbiAgfVxyXG4gIF9oYW5kbGVFc2NhcGVDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cENsb3NlQnV0dG9ufHwgZXZ0LnRhcmdldCA9PT0gdGhpcy5fcG9wdXBFbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgfVxyXG4gIHNldFN1Ym1pdEFjdGlvbihjYWxsYmFja0ZuKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gY2FsbGJhY2tGbjtcclxuICB9XHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIGNvbnN0IGlucHV0RWxlbWVudHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcbiAgICBpbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgY29uc29sZS5sb2codGhpcy5fcG9wdXBGb3JtKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdChpbnB1dFZhbHVlcyk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG4gIHNldFN1Ym1pdEJ1dHRvblRleHQodGV4dCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGV4dDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVBpY3R1cmVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1waWN0dXJlLWljb25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJldmlld0NhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1jYXJkLW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbmV4cG9ydCBjb25zdCBwcmV2aWV3Q2FwdGlvbkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWljb25cIik7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC10aXRsZS1pbnB1dFwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLXRpdGxlLWlucHV0XCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBhZGRGb3JtID0gYWRkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVQaWN0dXJlRm9ybSA9XHJcbiAgcHJvZmlsZVBpY3R1cmVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5leHBvcnQgY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9XHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNlZGl0LXByb2ZpbGUtY2xvc2UtYnV0dG9uXCJcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI2FkZC1jYXJkLWNsb3NlLWJ1dHRvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBjYXJkVVJMSW5wdXQgPSBhZGRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0X3R5cGVfdXJsXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVVSTElucHV0ID0gYWRkRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbnB1dF90eXBlX3VybFwiKTtcclxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZUNsb3NlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3ByZXZpZXctY2FyZC1pbWFnZS1jbG9zZS1idXR0b25cIlxyXG4pO1xyXG5cclxuLy9PYmplY3RzXHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzYWJsZVwiLFxyXG59O1xyXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnIFwiLFxyXG4gIH0sXHJcbl07XHJcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IHsgaW5pdGlhbENhcmRzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIHByb2ZpbGVJY29uLFxyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIHByb2ZpbGVFZGl0TW9kYWwsXHJcbiAgYWRkTW9kYWwsXHJcbiAgcHJldmlld0NhcmRNb2RhbCxcclxuICBwcm9maWxlVGl0bGUsXHJcbiAgcHJldmlld0ltYWdlRWwsXHJcbiAgcHJldmlld0NhcHRpb25FbCxcclxuICBwcm9maWxlRGVzY3JpcHRpb24sXHJcbiAgcHJvZmlsZUFkZEJ1dHRvbixcclxuICBwcm9maWxlVGl0bGVJbnB1dCxcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCxcclxuICBwcm9maWxlRWRpdEZvcm0sXHJcbiAgYWRkRm9ybSxcclxuICBwcm9maWxlUGljdHVyZUZvcm0sXHJcbiAgY2FyZHNMaXN0LFxyXG4gIGNhcmRMaXN0LFxyXG4gIGNhcmRUZW1wbGF0ZSxcclxuICBwcm9maWxlRWRpdENsb3NlQnV0dG9uLFxyXG4gIGFkZENhcmRDbG9zZUJ1dHRvbixcclxuICBjYXJkVVJMSW5wdXQsXHJcbiAgcHJldmlld0ltYWdlQ2xvc2VNb2RhbCxcclxuICBjb25maWcsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuY29uc3QgaGFuZGxlQWRkQ2FyZFN1Ym1pdCA9IChpbnB1dFZhbHVlcykgPT4ge1xyXG4gIGFwaS5jcmVhdGVDYXJkKGlucHV0VmFsdWVzKS50aGVuKChyZXMpID0+IHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChyZXMpO1xyXG4gICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgIG5ld0NhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1hZGQtbW9kYWxcIiwgKGlucHV0VmFsdWVzKSA9PiB7XHJcbiAgbmV3Q2FyZFBvcHVwLnNldFN1Ym1pdEJ1dHRvblRleHQoXCJTYXZpbmcuLi4uXCIpO1xyXG4gIGFwaVxyXG4gICAgLmNyZWF0ZUNhcmQoaW5wdXRWYWx1ZXMpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChyZXMpO1xyXG4gICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICBuZXdDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIG5ld0NhcmRQb3B1cC5zZXRTdWJtaXRCdXR0b25UZXh0KFwiU2F2ZVwiKTtcclxuICAgIH0pO1xyXG59KTtcclxuY29uc3QgY29uZmlybURlbGV0ZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjY29uZmlybS1jYXJkLWRlbGV0ZVwiLFxyXG4gIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gICAgY29uZmlybURlbGV0ZU1vZGFsLnNldFN1Ym1pdEJ1dHRvblRleHQoXCJEZWxldGluZy4uLi5cIik7XHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5pZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgIGNvbmZpcm1EZWxldGVNb2RhbC5jbG9zZSgpO1xyXG4gICAgICAgIHJlbmRlckl0ZW1zKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgY29uZmlybURlbGV0ZU1vZGFsLnNldFN1Ym1pdEJ1dHRvblRleHQoXCJEZWxldGVcIik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuKTtcclxuY29uc3QgY2hhbmdlUHJvZmlsZVBpY3R1cmUgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLXBpY3R1cmUtaWNvblwiLFxyXG4gIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gICAgY2hhbmdlUHJvZmlsZVBpY3R1cmUuc2V0U3VibWl0QnV0dG9uVGV4dChcIlNhdmluZy4uLi5cIik7XHJcbiAgICBhcGlcclxuICAgICAgLnVwZGF0ZVByb2ZpbGVQaWN0dXJlKGlucHV0VmFsdWVzKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMpO1xyXG4gICAgICAgIGNoYW5nZVByb2ZpbGVQaWN0dXJlLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgY2hhbmdlUHJvZmlsZVBpY3R1cmUuc2V0U3VibWl0QnV0dG9uVGV4dChcIlNhdmVcIik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuKTtcclxuXHJcbmNvbmZpcm1EZWxldGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gICAgY29uc29sZS5sb2coaW5wdXRWYWx1ZXMpO1xyXG5cclxuICAgIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG5cclxuICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhpbnB1dFZhbHVlcyk7XHJcbiAgICBlZGl0UHJvZmlsZVBvcHVwLnNldFN1Ym1pdEJ1dHRvblRleHQoXCJTYXZpbmcuLi4uXCIpO1xyXG4gICAgYXBpXHJcbiAgICAgIC5lZGl0VXNlclByb2ZpbGUoe1xyXG4gICAgICAgIG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGlucHV0VmFsdWVzLmFib3V0LFxyXG4gICAgICB9KVxyXG5cclxuICAgICAgLnRoZW4oKHsgbmFtZSwgYWJvdXQgfSkgPT4ge1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICAgIGFsZXJ0KGAke2Vycn0uRmFpbGVkIHRvIHVwZGF0ZSBwcm9maWxlYCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBlZGl0UHJvZmlsZVBvcHVwLnNldFN1Ym1pdEJ1dHRvblRleHQoXCJTYXZlXCIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbik7XHJcblxyXG5jb25zdCBlZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbm5ld0NhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IGltYWdlQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3ByZXZpZXctY2FyZC1tb2RhbFwiKTtcclxuaW1hZ2VDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vRWxlbWVudHNcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxyXG4gIFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICBcIi5wcm9maWxlX19pbWFnZVwiXHJcbik7XHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZmlsZUVkaXRGb3JtKTtcclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgYWRkRm9ybSk7XHJcbmNvbnN0IHByb2ZpbGVQaWN0dXJlVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBwcm9maWxlUGljdHVyZUZvcm0pO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiZTNmNWJjNjQtYzI3OS00NDc0LTljNjUtOGM1YWUwODMxZWI5XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuLy9GdW5jdGlvbnNcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soY2FyZERhdGEpIHtcclxuICBpbWFnZUNhcmRQb3B1cC5vcGVuKGNhcmREYXRhKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKCkge1xyXG4gIHRoaXMuX2NhcmREZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoKTtcclxuICB9KTtcclxufVxyXG4vLyBydW4gd2hlbiB5b3UgY2xpY2sgdGhlIGRlbGV0ZSBidXR0b24gb24gYSBjYXJkXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGNhcmQpIHtcclxuICBjb25zb2xlLmxvZyhjYXJkKTtcclxuICBjb25maXJtRGVsZXRlTW9kYWwub3BlbigpO1xyXG4gIGNvbmZpcm1EZWxldGVNb2RhbC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgY29uZmlybURlbGV0ZU1vZGFsLnNldFN1Ym1pdEJ1dHRvblRleHQoXCJEZWxldGluZy4uLi5cIik7XHJcbiAgICAvLyB0aGlzIGFycm93IGZ1bmN0aW9uIHJ1bnMgd2hlbiB5b3Ugc3VibWl0IHRoZSBjb25maXJtYXRpb24gbW9kYWxcclxuICAgIGFwaVxyXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLmlkKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XHJcbiAgICAgICAgY29uZmlybURlbGV0ZU1vZGFsLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgY29uZmlybURlbGV0ZU1vZGFsLnNldFN1Ym1pdEJ1dHRvblRleHQoXCJEZWxldGVcIik7XHJcbiAgICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vLyBFdmVudExpc3RlbmVyXHJcbmNoYW5nZVByb2ZpbGVQaWN0dXJlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnByb2ZpbGVJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2hhbmdlUHJvZmlsZVBpY3R1cmUub3BlbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgeyBuYW1lLCBhYm91dCB9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBhYm91dDtcclxuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcclxufSk7XHJcbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBuZXdDYXJkUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBjYXJkRGF0YSxcclxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVQcm9maWxlUGljdHVyZSgpIHtcclxuICB1cGRhdGVQcm9maWxlUGljdHVyZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG59XHJcblxyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5wcm9maWxlUGljdHVyZVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbi8vZ2V0IHVzZXIgaW5mbyBmcm9tIHNlcnZlciBhbmQgc2V0IGl0IGxvY2FsbHkgb24gdGhlIHBhZ2VcclxuYXBpXHJcbiAgLmxvYWRVc2VySW5mbygpXHJcbiAgLnRoZW4oKGluZm8pID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGluZm8pO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihpbmZvKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICBhbGVydChgJHtlcnJ9LiBGYWlsZWQgdG8gZ2V0IHVzZXIgaW5mby5gKTtcclxuICB9KTtcclxuXHJcbi8vIGdldCBjYXJkcyBmcm9tIHNlcnZlciBhbmQgcmVuZGVyIHRoZW0gb24gdGhlIHBhZ2VcclxubGV0IHNlY3Rpb247XHJcblxyXG5hcGlcclxuICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbigoY2FyZHMpID0+IHtcclxuICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiBjYXJkcy5yZXZlcnNlKCksXHJcbiAgICAgICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcclxuICAgICAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgXCIuY2FyZHNfX2xpc3RcIlxyXG4gICAgKTtcclxuICAgIHNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICBhbGVydChgJHtlcnJ9LiBGYWlsZWQgdG8gYWRkIGNhcmQuYCk7XHJcbiAgfSk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2soY2FyZCkge1xyXG4gIGFwaVxyXG4gICAgLmxpa2VDYXJkKGNhcmQuaWQsIGNhcmQuaXNMaWtlZClcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY2FyZC5zZXRJc0xpa2VkKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICBhbGVydChgJHtlcnJ9LiBGYWlsZWQgdG8gbGlrZSBvciBkaXNsaWtlIGNhcmRgKTtcclxuICAgIH0pO1xyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gIH1cclxuICBvcGVuKGNhcmREYXRhKSB7XHJcbiAgICBjb25zdCBwb3B1cEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgcG9wdXBJbWFnZS5zcmMgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgcG9wdXBJbWFnZS5hbHQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgY29uc3QgcG9wdXBDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XHJcbiAgICBwb3B1cENhcHRpb24udGV4dENvbnRlbnQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBhYm91dFNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhYm91dFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGFib3V0OiB0aGlzLl9hYm91dC50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhpbnB1dFZhbHVlcykge1xyXG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IGlucHV0VmFsdWVzLm5hbWU7XHJcbiAgICB0aGlzLl9hYm91dC50ZXh0Q29udGVudCA9IGlucHV0VmFsdWVzLmFib3V0O1xyXG4gIH1cclxuICBzZXRVc2VyQXZhdGFyKGlucHV0VmFsdWVzKSB7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gaW5wdXRWYWx1ZXMuYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5jaGVja1Jlc3BvbnNlKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNyZWF0ZUNhcmQoaW5wdXRWYWx1ZXMpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoaW5wdXRWYWx1ZXMpLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNoZWNrUmVzcG9uc2UocmVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBlZGl0VXNlclByb2ZpbGUocmVzKSB7XHJcbiAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IHJlcy5uYW1lLFxyXG4gICAgICAgIGFib3V0OiByZXMuYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNoZWNrUmVzcG9uc2UocmVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoY2FyZElkLCBpc0xpa2VkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5jaGVja1Jlc3BvbnNlKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5jaGVja1Jlc3BvbnNlKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGxvYWRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL3VzZXJzL21lXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNoZWNrUmVzcG9uc2UocmVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICB1cGRhdGVQcm9maWxlUGljdHVyZShpbnB1dFZhbHVlcykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhciBgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogaW5wdXRWYWx1ZXMubGluayB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5jaGVja1Jlc3BvbnNlKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImNhcmREYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwidGhpcyIsIl9jYXJkRGF0YSIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJpZCIsIl9pZCIsIl9saWtlcyIsImxpa2VzIiwiaXNMaWtlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9jYXJkRGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZUVsIiwiZGVsZXRlQ2FyZCIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsInJlbmRlckxpa2UiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRJc0xpa2VkIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImdldFZpZXciLCJfZWxlbWVudCIsIl9jYXJkVGl0bGVFbCIsInNldEF0dHJpYnV0ZSIsInRleHRDb250ZW50Iiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9zZXR0aW5ncyIsIl9mb3JtIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9zdWJtaXRCdXR0b24iLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbnB1dEVscyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwiaW5wdXRFcnJvckNsYXNzIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvckNsYXNzIiwiZm9yRWFjaCIsImUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJldmVyeSIsInJlc2V0VmFsaWRhdGlvbiIsIlNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfcG9wdXBDbG9zZUJ1dHRvbiIsIm9wZW4iLCJfaGFuZGxlRXNjYXBlQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJzZXRTdWJtaXRBY3Rpb24iLCJjYWxsYmFja0ZuIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicmVzZXQiLCJjb25zb2xlIiwibG9nIiwic2V0U3VibWl0QnV0dG9uVGV4dCIsInRleHQiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0TW9kYWwiLCJhZGRNb2RhbCIsInByb2ZpbGVQaWN0dXJlTW9kYWwiLCJwcm9maWxlSWNvbiIsInByb2ZpbGVBZGRCdXR0b24iLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkRm9ybSIsInByb2ZpbGVQaWN0dXJlRm9ybSIsImNvbmZpZyIsImZpcnN0RWxlbWVudENoaWxkIiwiZm9ybVNlbGVjdG9yIiwibmV3Q2FyZFBvcHVwIiwiYXBpIiwiY3JlYXRlQ2FyZCIsInRoZW4iLCJyZXMiLCJjYXJkRWxlbWVudCIsInNlY3Rpb24iLCJhZGRGb3JtVmFsaWRhdG9yIiwiZmluYWxseSIsImNvbmZpcm1EZWxldGVNb2RhbCIsImNhcmQiLCJjYXRjaCIsImVyciIsImVycm9yIiwiY2hhbmdlUHJvZmlsZVBpY3R1cmUiLCJ1cGRhdGVQcm9maWxlUGljdHVyZSIsInVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsImVkaXRQcm9maWxlUG9wdXAiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImVkaXRVc2VyUHJvZmlsZSIsImFib3V0Iiwic2V0VXNlckluZm8iLCJhbGVydCIsImltYWdlQ2FyZFBvcHVwIiwicG9wdXBJbWFnZSIsInNyYyIsImFsdCIsIm5hbWVTZWxlY3RvciIsImFib3V0U2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9hYm91dCIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsImF2YXRhciIsIkZvcm1WYWxpZGF0b3IiLCJwcm9maWxlUGljdHVyZVZhbGlkYXRvciIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImNoZWNrUmVzcG9uc2UiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImxpa2VDYXJkIiwiY2FyZElkIiwibG9hZFVzZXJJbmZvIiwiYXV0aG9yaXphdGlvbiIsImluZm8iLCJjYXJkcyIsInJldmVyc2UiXSwic291cmNlUm9vdCI6IiJ9